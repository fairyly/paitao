<!DOCTYPE html>
<html>
<head>
<title>订单详情</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<link rel="stylesheet" href="css/base_style.css" type="text/css" />
</script>
</head>
<body>
<input type="hidden" id="activateNumber" />
	<div class="banner">
		<h1>订单详情</h1>
			<a class="btnr">
			<div onclick="history.go(-1);" >返回</div>
			</a>
			<a class="btna" href="javascript:location.reload();">
			<div class="refreshbtnbg">刷新</div>
		</a>
	</div>
<div id="main" class="orderbg">
<div class="order_title"><p>订单状态(<span id="orderid"></span>)
<span style="margin-left: 30%" class="ord_ztcol5" id="status"></span></p></div>
<span id="commodityDetail"></span>
<div class="order_title">
<p>收货地址</p></div>
<div class="orddet_shdz">
<div class="orddet_shleft1">地址</div><p class="orddet_shright"><span id="address"></span></p>
<div style="clear: both"></div>
<div class="orddet_shleft1">姓名</div><div class="orddet_shright"><span id="consignee"></span></div>
<div style="clear: both"></div>
<div class="orddet_shleft">电话</div><div class="orddet_shright"><span id="phone"></span></div>
<div style="clear: both"></div>
<br/>
</div>
<div class="order_title">
<p>订单信息</p></div>
<div class="orddet_shleft">订单日期</div><p class="orddet_shright"><span id="time"></span></p>
<br>
<span id="consult"></span>
</div>
<br>
<br>
<br>

<script src="js/jq.js"></script>
<script src="js/jquery.common.js"></script>
<script type="text/javascript">
function goto_board(id,channelId){
	window.localStorage.setItem("message_talk.html","message_talk.html?orderId="+id+"&channelId="+channelId);
	window.location.href="message_talk.html";
}
$(document).ready(function(){
	var activateNumber;
	 try{
		activateNumber = window.myAndroidJs.getActivateNumber();
    }catch(e){
    	activateNumber = 869783010658111;//测试环境下需要模拟一个imei
	}
	$("#activateNumber").val(activateNumber);
	var id = $.get_param('id');
	getDetail(id);
});
function getDetail(id){
	var result="";
  	try{
  		result = window.myAndroidJs.doPostHttpRequest($.get_path("market?type=185&id="+id+""));
  	}catch (e) {
  		$.getJSON("http://api.wedanke.com/server/market?jsoncallback=?",{
		   type : 185,
		   id : id
		},function(result){
			if(result.result == "1"){
				var orderid = result.data.order.id;
				var status = result.data.order.status;
				var address = result.data.order.address;
				var consignee = result.data.order.consignee;
				var phone = result.data.order.phone;
				var time = result.data.order.time;
				var channelId = result.data.order.channelId;
				$("#orderid").html(orderid);
				switch (status) {
				case 1:
					$("#status").html("已确认");
					break;
				case 5:
					$("#status").html("已发货");
					break;
				case 6:
					$("#status").html("交易取消");
					break;
				case 7:
					$("#status").html("交易成功");
					break;
				default:
					$("#status").html("未确认");
					break;
				}
				$("#address").html(address);
				$("#consignee").html(consignee);
				$("#phone").html(phone);
				$("#time").html(time);
				$("#consult").html("<div class=\"order_btn\" onclick=\"goto_board("+orderid+","+channelId+");\"> 客服咨询</div>");
				var arr = new Array("");
				var o = result.data.commodityList;
				for(var i=0;i<o.length;i++){
					arr.push("<div class=\"orddet_xq\">");
					arr.push("<div class=\"order_img\">");
					arr.push("<img src="+o[i].icon+" ></div>");
					arr.push("<div class=\"orddet_xqright\">");
					arr.push("<font class=\"orddet_xqtit\">"+o[i].name+"</font>");
					arr.push("<span class=\"orddet_color\">颜色:"+o[i].color+"</span><span class=\"orddet_size\">尺码:"+o[i].size+"</span>");
					arr.push("<div class=\"orddet_goodnum\">数量:"+o[i].num+"</div>");
					arr.push("<div class=\"orddet_pri\">￥<font>");
					if(o[i].currentPrice==0.00)
						arr.push("0</font>");
					else
						arr.push(""+o[i].currentPrice+"</font>");
					arr.push("</div></div></div>");
				}
				$("#commodityDetail").html(arr.join(''));
			}
		});
	}
	if(result!="")
	{
		//result = eval('('+ result +')');
		result = JSON.parse(result);
		if(result.result == "1"){
			var orderid = result.data.order.id;
			var status = result.data.order.status;
			var address = result.data.order.address;
			var consignee = result.data.order.consignee;
			var phone = result.data.order.phone;
			var time = result.data.order.time;
			var channelId = result.data.order.channelId;
			$("#orderid").html(orderid);
			switch (status) {
			case 1:
				$("#status").html("已确认");
				break;
			case 5:
				$("#status").html("已发货");
				break;
			case 6:
				$("#status").html("交易取消");
				break;
			case 7:
				$("#status").html("交易成功");
				break;
			default:
				$("#status").html("未确认");
				break;
			}
			$("#address").html(address);
			$("#consignee").html(consignee);
			$("#phone").html(phone);
			$("#time").html(time);
			$("#consult").html("<div class=\"order_btn\" onclick=\"goto_board("+orderid+","+channelId+");\"> 客服咨询</div>");
			var arr = new Array("");
			var o = result.data.commodityList;
			for(var i=0;i<o.length;i++){
				arr.push("<div class=\"orddet_xq\">");
				arr.push("<div class=\"order_img\">");
				arr.push("<img src="+o[i].icon+" ></div>");
				arr.push("<div class=\"orddet_xqright\">");
				arr.push("<font class=\"orddet_xqtit\">"+o[i].name+"</font>");
				arr.push("<span class=\"orddet_color\">颜色:"+o[i].color+"</span><span class=\"orddet_size\">尺码:"+o[i].size+"</span>");
				arr.push("<div class=\"orddet_goodnum\">数量:"+o[i].num+"</div>");
				arr.push("<div class=\"orddet_pri\">￥<font>");
				if(o[i].currentPrice==0.00)
					arr.push("0</font>");
				else
					arr.push(""+o[i].currentPrice+"</font>");
				arr.push("</div></div></div>");
			}
			$("#commodityDetail").html(arr.join(''));
		}
	}
}
</script>
</body>
</html>